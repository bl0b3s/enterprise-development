# Лабораторная работа 4: Генератор контрактов и обмен сообщениями через gRPC


## Вариант 80

* **Platform**: .NET 8 (C# 12)
* **Database**: SqlServer
* **ORM**: Entity Framework Core 8
* **Messaging**: gRPC
* **Mapping**: AutoMapper
* **Testing**: xUnit, Bogus (Fake Data)
* **Orchestration**: .NET Aspire


## Описание предметной области

Реализована объектная модель для пункта проката автомобилей со следующими сущностями:

- **`CarModel`** – модель автомобиля (справочник): тип привода, класс, тип кузова, количество мест.
- **`ModelGeneration`** – поколение модели: год выпуска, объём двигателя, коробка передач, стоимость часа аренды.
- **`Car`** – физический экземпляр автомобиля: госномер, цвет, поколение модели.
- **`Customer`** – клиент: номер водительского удостоверения, ФИО, дата рождения.
- **`Rental`** – договор аренды: клиент, автомобиль, время выдачи, длительность в часах.

## Реализованные компоненты

### CarRental.Producer

Сервис-генератор контрактов аренды с REST API:

- **`RequestStreamingService`** — генерирует тестовые DTO записей об аренде с использованием библиотеки Bogus. отправляет пачки контрактов через протокол gRPC
- **`GeneratorController`** — REST-контроллер для запуска генерации через HTTP-запрос:

### CarRental.Consumer

Слой для приема сообщений от Producer:

- **`RequestStreamingService`** — сервис который:
  - Обрабатывает входящие сообщения с контрактами
  - Валидирует связи с существующими `Car` и `Client`
  - Сохраняет валидные записи об аренде в базу данных


## Результат 4 лабораторной работы

- Реализован сервис-генератор контрактов (CarRental.Producer), который создаёт тестовые записи об аренде и отправляет их через gRPC Server Streaming.
- Реализован gRPC-клиент (CarRental.Consumer), который получает контракты из потока и сохраняет их в базу данных с валидацией связей.
- Создан proto-контракт взаимодействия в слое Application.
- В конфигурацию Aspire добавлен запуск Producer и Consumer с автоматическим обнаружением адресов.
- Все компоненты запускаются через единый оркестратор с автоматическим управлением зависимостями